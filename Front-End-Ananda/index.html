<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Scrapping Web Pokemon</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
		integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="./css/style.css">
	<style>
		.gacha {
			height: 50vh;
			width: 90vw;
		}
	</style>
</head>

<body>
	<div class="container mx-auto round container-padding">
		<div id="pokemon-detail">
			<div class="spacer-2rem">
			   <h4 class="text-center">Pokemon Data</h4>
			</div>
			<div class="text-center poke-img-container" id="pokemon-detail-img"></div>
			<div class="">
			   <div class="row">
				  <div class="col-6 text-right">National No:</div>
				  <div class="col-6" id="pokemon-detail-natno"></div>
				  <div class="col-6 text-right">Type:</div>
				  <div class="col-6" id="pokemon-detail-type"></div>
				  <div class="col-6 text-right">Species:</div>
				  <div class="col-6" id="pokemon-detail-species"></div>
				  <div class="col-6 text-right">Height:</div>
				  <div class="col-6" id="pokemon-detail-height"></div>
				  <div class="col-6 text-right">Weight:</div>
				  <div class="col-6" id="pokemon-detail-weight"></div>
				  <div class="col-6 text-right">Abilities:</div>
				  <div class="col-6">
					  <span class="text-muted">1. <a target="_blank" href="https://pokemondb.net/ability/oblivious" title="Prevents it from becoming infatuated.">Oblivious</a></span><br><span class="text-muted"> 2. <a target="_blank" href="https://pokemondb.net/ability/own-tempo" title="Prevents the Pokémon from becoming confused.">Own Tempo</a></span><br><small class="text-muted"><a target="_blank" href="https://pokemondb.net/ability/regenerator" title="Restores a little HP when withdrawn from battle.">Regenerator</a> (hidden ability)</small><br></div>
				  <div class="col-6 text-right">Catch Rate:</div>
				  <div class="col-6" id="pokemon-detail-catch-rate"> </div>
				  <div class="col-6 text-right">Growth Rate:</div>
				  <div class="col-6" id="pokemon-detail-growth-rate"> Medium Fast</div>
			   </div>
			</div>
			<div class="spacer-2rem">
			   <h4 class="text-center">Base Stats</h4>
			</div>
			<div class="">
			   <div class="row">
				  <table class="table table-dark table-noborder">
					 <thead></thead>
					 <tbody>
						<tr>
						   <th>HP</th>
						   <td class="cell-num" id="pokemon-detail-current-hp"></td>
						   <td class="cell-num" id="pokemon-detail-min-hp"></td>
						   <td class="cell-num" id="pokemon-detail-max-hp"></td>
						</tr>
						<tr>
						   <th>Attack</th>
						   <td class="cell-num" id="pokemon-detail-current-attack"></td>
						   <td class="cell-num" id="pokemon-detail-min-attack"></td>
						   <td class="cell-num" id="pokemon-detail-max-attack"></td>
						</tr>
						<tr>
						   <th>Defense</th>
						   <td class="cell-num" id="pokemon-detail-current-defense"></td>
						   <td class="cell-num" id="pokemon-detail-min-defense"></td>
						   <td class="cell-num" id="pokemon-detail-max-defense"></td>
						</tr>
						<tr>
						   <th>Sp. Atk</th>
						   <td class="cell-num" id="pokemon-detail-current-spattack"></td>
						   <td class="cell-num" id="pokemon-detail-min-spattack"></td>
						   <td class="cell-num" id="pokemon-detail-max-spattack"></td>
						</tr>
						<tr>
						   <th>Sp. Def</th>
						   <td class="cell-num" id="pokemon-detail-current-spdefense"></td>
						   <td class="cell-num" id="pokemon-detail-min-spdefense"></td>
						   <td class="cell-num" id="pokemon-detail-max-spdefense"></td>
						</tr>
						<tr>
						   <th>Speed</th>
						   <td class="cell-num" id="pokemon-detail-current-speed"></td>
						   <td class="cell-num" id="pokemon-detail-min-speed"></td>
						   <td class="cell-num" id="pokemon-detail-max-speed"></td>
						</tr>
					 </tbody>
				  </table>
			   </div>
			</div>
			<h5>Slowpoke's Evolution</h5>
			<div class="infocard-list-evo">
			   <div class="infocard"><span class="infocard-lg-img"><a href="/pokedex/slowpoke"><img src="https://img.pokemondb.net/sprites/bank/normal/slowpoke.png" data-alt="Slowpoke sprite"></a><span class="infocard-lg-data text-muted"><small>#079</small><br> <a class="ent-name" href="/pokedex/slowpoke">Slowpoke</a><br> <small><a href="/type/water" class="itype water">Water</a> · <a href="/type/psychic" class="itype psychic">Psychic</a></small></span></span></div>
			   <span class="infocard-evo-split">
				  <span class="infocard-list-evo">
					 <div class="infocard-list-evo">
						<span class="infocard infocard-arrow">
						   <small>(Level 37)</small><i class="icon-arrow icon-arrow-ne"></i>
						   <div class="infocard"><span class="infocard-lg-img"><a href="/pokedex/slowbro"><img src="https://img.pokemondb.net/sprites/bank/normal/slowbro.png" data-alt="Slowbro sprite"></a><span class="infocard-lg-data text-muted"><small>#080</small><br> <a class="ent-name" href="/pokedex/slowbro">Slowbro</a><br> <small><a href="/type/water" class="itype water">Water</a> · <a href="/type/psychic" class="itype psychic">Psychic</a></small></span></span></div>
						</span>
					 </div>
					 <span class="infocard-list-evo">
						<div class="infocard-list-evo">
						   <span class="infocard infocard-arrow">
							  <i class="icon-arrow icon-arrow-se"></i><small>(trade holding <a href="/item/kings-rock">Kings Rock</a>)</small>
							  <div class="infocard"><span class="infocard-lg-img"><a href="/pokedex/slowking"><img src="https://img.pokemondb.net/sprites/bank/normal/slowking.png" data-alt="Slowking sprite"></a><span class="infocard-lg-data text-muted"><small>#199</small><br> <a class="ent-name" href="/pokedex/slowking">Slowking</a><br> <small><a href="/type/water" class="itype water">Water</a> · <a href="/type/psychic" class="itype psychic">Psychic</a></small></span></span></div>
						   </span>
						</div>
					 </span>
				  </span>
			   </span>
			</div>
		 </div>
	</div>

	<div class="container mx-auto round">
		<table class='table table-dark '>
			<thead class='thead-darks'>
				<tr>
					<th style="width:25%">National No</th>
					<th style="width:25%">Image</th>
					<th style="width:50%">Name</th>
				</tr>
            </thead>
            
			<!-- <tbody> -->
            <tbody id="table-pokemon">
                
            </tbody>
		</table>
	</div>

	<script type="text/javascript">
		$('a[href*="#"]').not('[href="#"]').not('[href="#0"]').click(function(event) {
			if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') && location.hostname == this.hostname) {
				
				var target = $(this.hash);
				target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');

				if (target.length) {
					event.preventDefault();
					$('html, body').animate({
						scrollTop: target.offset().top
					}, 1500, function() {
						var $target = $(target);
						$target.focus();
						if ($target.is(":focus")) {
							return false;
						} else {
							$target.attr('tabindex','-1');
							$target.focus();
						};
					});
				}
			}
		});

		function displayDetail(pokeName){
			// console.log(pokeUrl);
			$.ajax({
				method: 'PUT',
				url: 'https://163.172.153.50/api_pokemon_detail.php?name=' + pokeName.toLowerCase(),
			}).done(function(msg) {
				// console.log(msg);
                var data = JSON.parse(msg);
                console.log(data.national_number);
				$('#pokemon-detail-img').html('<img class="poke-img" src="'+data.image+'">');
				$('#pokemon-detail-natno').html(' #<strong>'+data.national_number+'</strong>');
				$('#pokemon-detail-type').html('');
				data.type.forEach(function(item){
					document.getElementById('pokemon-detail-type').innerHTML += '<a class="type-icon type-'+item.toLowerCase()+'" target="_blank" href="https://pokemondb.net/type/'+item.toLowerCase()+'">'+item+'</a>';
				});
				$('#pokemon-detail-species').html(data.species);
				$('#pokemon-detail-height').html(data.height);
				$('#pokemon-detail-weight').html(data.weight);

				// var catch_rate = JSON.parse(data.catch_rate);
				$('#pokemon-detail-catch-rate').html(data.catch_rate.Percentage +'% <small class="text-muted">'+data.catch_rate.Detail+'</small>');
				$('#pokemon-detail-growth-rate').html(data.growth_rate);
				
				$('#pokemon-detail-current-hp').html(data.hp.current);
				$('#pokemon-detail-min-hp').html(data.hp.min);
				$('#pokemon-detail-max-hp').html(data.hp.max);

				$('#pokemon-detail-current-attack').html(data.attack.current);
				$('#pokemon-detail-min-attack').html(data.attack.min);
				$('#pokemon-detail-max-attack').html(data.attack.max);

				$('#pokemon-detail-current-defense').html(data.defense.current);
				$('#pokemon-detail-min-defense').html(data.defense.min);
				$('#pokemon-detail-max-defense').html(data.defense.max);

				$('#pokemon-detail-current-spattack').html(data.sp_attack.current);
				$('#pokemon-detail-min-spattack').html(data.sp_attack.min);
				$('#pokemon-detail-max-spattack').html(data.sp_attack.max);

				$('#pokemon-detail-current-spdefense').html(data.sp_defense.current);
				$('#pokemon-detail-min-spdefense').html(data.sp_defense.min);
				$('#pokemon-detail-max-spdefense').html(data.sp_defense.max);

				$('#pokemon-detail-current-speed').html(data.speed.current);
				$('#pokemon-detail-min-speed').html(data.speed.min);
				$('#pokemon-detail-max-speed').html(data.speed.max);

			});
		}
        
        $(document).ready(function(){
			var ExampleRow = `
				<tr>
					<td>001</td>
					<td><img src="https://img.pokemondb.net/sprites/sword-shield/icon/bulbasaur.png"></td>
					<td><a href="#pokemon-detail" onclick="displayDetail('Bulbasaur')">Bulbasaur</a></td>
				</tr>`;
            $.ajax({
                method: 'PUT',
                url: 'https://163.172.153.50/api.php',
				dataType : 'json',
				
                success: function(data){
					var AllRow = '';
					
                    data.forEach(element => {
                        // console.log(element);
                        var pokemonype = '';

                        for(var i=0; i<element["TYPE"].length; i++){
                            pokemonype += element["TYPE"][i];
                            if(i!=element["TYPE"].length-1) pokemonype += ', ';
                        }

                        var Row = `<tr>
                                <td>`+element["ID"]+`</td>
                                <td><img src="`+element["IMG"]+`"></td>`;
                        if(element["ALT_NAME"]) {
                            Row += `<td><a href="#pokemon-detail" onclick="displayDetail('`+element["NAME"]+`')">`+element["NAME"]+`</a><br><div class='smaller-text'>`+element["ALT_NAME"]+`</div></td></tr>`;
                        } else {
                            Row += `<td><a href="#pokemon-detail" onclick="displayDetail('`+element["NAME"]+`')">`+element["NAME"]+`</a></td></tr>`;
                        }
                        AllRow += Row;
                    });
                    $("#table-pokemon").html(AllRow);
                },
                error: function(xhr) {
                    console.log("Error: " + xhr.statusText);
                }
            });
        });
	</script>
</body>

</html>